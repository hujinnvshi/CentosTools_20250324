CentOS Linux release 7.x 系统，给我一个bash脚本

检索当前系统拥有的所有的全部 IP 地址，仅仅需要ipv4的地址。

处于监听状态、向外暴露的端口,以及对应的进程，以及对应的进程的用户，按照进程名称进行排序。

当前所有外部连接的 IP 地址，以及与之对应的接入本地的进程，本地端口，按照进程进行汇总，即一个进程对应多个端口，保持整齐的格式。

经全部的数据保存为格式 到本地的excel文件中，每个数据保存到一个sheet中。